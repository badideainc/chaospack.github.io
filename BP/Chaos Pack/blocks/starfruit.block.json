{
	"format_version": "1.21.60",
	"minecraft:block": {
		"description": {
			"identifier": "chaospack:starfruit",
			"menu_category": {
				"category": "none" // Hide from creative inventory - seeds should be used to place.
			},
			"states": {
				"chaospack:growth": {
					"values": {
						"min": 0,
						"max": 7
					}
				}
			}
		},
		"components": {
			"minecraft:collision_box": false,
			"minecraft:geometry": "geometry.crop", // Model provided in previous step.
			"minecraft:light_dampening": 0,
			// Break the crop if it isn't placed on farmland.
			"minecraft:placement_filter": {
				"conditions": [
					{
						"allowed_faces": [ "up" ],
						"block_filter": [ "minecraft:farmland" ]
					}
				]
			},
			// Break the crop when water flows into it.
			"minecraft:liquid_detection": {
				"detection_rules": [
					{
						"liquid_type": "water",
						"on_liquid_touches": "popped"
					}
				]
			}
		},
		"permutations": [
			{
				"condition": "q.block_state('chaospack:growth') < 7",
				"components": {
					// Loot table for when the crop is not fully grown. Vanilla crops only drop seeds when young.
					"minecraft:loot": "loot_tables/blocks/starfruit_young.json",
					// Trigger growth on random ticks and when interacting with bone meal (only active when the block isn't fully grown).
					"minecraft:custom_components": [ "chaospack:custom_crop_growth" ]
				}
			},
			{
				"condition": "q.block_state('chaospack:growth') >= 0",
				"components": {
					"minecraft:material_instances": {
						"*": {
							"texture": "starfruit_stage_0",
							"render_method": "alpha_test_single_sided",
							"ambient_occlusion": false,
							"face_dimming": false
						}
					}
				}
			},
			{
				"condition": "q.block_state('chaospack:growth') == 0",
				"components": {
					"minecraft:selection_box": {
						"origin": [ -8, 0, -8 ],
						"size": [ 16, 1.6, 16 ]
					}
				}
			},
			{
				"condition": "q.block_state('chaospack:growth') == 1",
				"components": {
					"minecraft:selection_box": {
						"origin": [ -8, 0, -8 ],
						"size": [ 16, 3.2, 16 ]
					}
				}
			},
			{
				"condition": "q.block_state('chaospack:growth') >= 2",
				"components": {
					"minecraft:material_instances": {
						"*": {
							"texture": "starfruit_stage_1",
							"render_method": "alpha_test_single_sided",
							"ambient_occlusion": false,
							"face_dimming": false
						}
					}
				}
			},
			{
				"condition": "q.block_state('chaospack:growth') == 2",
				"components": {
					"minecraft:selection_box": {
						"origin": [ -8, 0, -8 ],
						"size": [ 16, 4.8, 16 ]
					}
				}
			},
			{
				"condition": "q.block_state('chaospack:growth') == 3",
				"components": {
					"minecraft:selection_box": {
						"origin": [ -8, 0, -8 ],
						"size": [ 16, 6.4, 16 ]
					}
				}
			},
			{
				"condition": "q.block_state('chaospack:growth') >= 4",
				"components": {
					"minecraft:material_instances": {
						"*": {
							"texture": "starfruit_stage_2",
							"render_method": "alpha_test_single_sided",
							"ambient_occlusion": false,
							"face_dimming": false
						}
					}
				}
			},
			{
				"condition": "q.block_state('chaospack:growth') == 4",
				"components": {
					"minecraft:selection_box": {
						"origin": [ -8, 0, -8 ],
						"size": [ 16, 8, 16 ]
					}
				}
			},
			{
				"condition": "q.block_state('chaospack:growth') == 5",
				"components": {
					"minecraft:selection_box": {
						"origin": [ -8, 0, -8 ],
						"size": [ 16, 9.6, 16 ]
					}
				}
			},
			{
				"condition": "q.block_state('chaospack:growth') == 6",
				"components": {
					"minecraft:selection_box": {
						"origin": [ -8, 0, -8 ],
						"size": [ 16, 11.2, 16 ]
					}
				}
			},
			{
				"condition": "q.block_state('chaospack:growth') == 7",
				"components": {
					"minecraft:material_instances": {
						"*": {
							"texture": "starfruit_stage_3",
							"render_method": "alpha_test_single_sided",
							"ambient_occlusion": false,
							"face_dimming": false
						}
					},
					"minecraft:selection_box": {
						"origin": [ -8, 0, -8 ],
						"size": [ 16, 12.8, 16 ]
					},
					// Drop different loot when fully grown
					"minecraft:loot": "loot_tables/blocks/starfruit_mature.json"
				}
			}
		]
	}
}